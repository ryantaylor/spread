<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Spread
  
    &mdash; Documentation by YARD 0.9.5
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Spread";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (S)</a> &raquo;
    
    
    <span class="title">Spread</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <iframe id="search_frame" src="class_list.html"></iframe>

      <div id="content"><h1>Module: Spread
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/spread.rb<span class="defines">,<br />
  lib/spread/bond.rb,<br /> lib/spread/version.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Bond spread-to-benchmark and spread-to-curve calculator.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Spread/Bond.html" title="Spread::Bond (class)">Bond</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  <dl class="constants">
    
      <dt id="CORPORATE-constant" class="">CORPORATE =
        <div class="docstring">
  <div class="discussion">
    
<p>Corporate bond issue type identifier.</p>


  </div>
</div>
<div class="tags">
  

</div>
      </dt>
      <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>corporate</span><span class='tstring_end'>&quot;</span></span></pre></dd>
    
      <dt id="GOVERNMENT-constant" class="">GOVERNMENT =
        <div class="docstring">
  <div class="discussion">
    
<p>Government bond issue type identifier.</p>


  </div>
</div>
<div class="tags">
  

</div>
      </dt>
      <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>government</span><span class='tstring_end'>&quot;</span></span></pre></dd>
    
      <dt id="VERSION-constant" class="">VERSION =
        <div class="docstring">
  <div class="discussion">
    
<p>Application version.</p>


  </div>
</div>
<div class="tags">
  

</div>
      </dt>
      <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.1.0</span><span class='tstring_end'>&quot;</span></span></pre></dd>
    
  </dl>







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#calc-class_method" title="calc (class method)">.<strong>calc</strong>(csv_file)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Parses the given CSV file and runs calculation procedures to determine the
spread to benchmark and spread to curve of the given bonds.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_csv-class_method" title="parse_csv (class method)">.<strong>parse_csv</strong>(csv_file)  &#x21d2; [Array&lt;Bond&gt;, Array&lt;Bond&gt;] </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Parses the given CSV file and splits bonds into two arrays, one for
corporate issues and one for government issues.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#spread_to_benchmark-class_method" title="spread_to_benchmark (class method)">.<strong>spread_to_benchmark</strong>(corporate_bonds, government_bonds)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Takes an array of corporate and an array of government bonds, finds the
appropriate government benchmark bond for each corporate bond, and then
calculates the yield spreads from the corporate bonds to their
corresponding benchmark government bonds.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#spread_to_curve-class_method" title="spread_to_curve (class method)">.<strong>spread_to_curve</strong>(corporate_bonds, government_bonds)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Takes an array of corporate and an array of government bonds and
calculates, using linear interpolation, the spread to curve for each
corporate bond.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="calc-class_method">
  
    .<strong>calc</strong>(csv_file)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Parses the given CSV file and runs calculation procedures to determine the
spread to benchmark and spread to curve of the given bonds.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>csv_file</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Path to a properly formatted CSV file of bond information.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


18
19
20
21
22</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/spread.rb', line 18</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_calc'>calc</span><span class='lparen'>(</span><span class='id identifier rubyid_csv_file'>csv_file</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_corporate_bonds'>corporate_bonds</span><span class='comma'>,</span> <span class='id identifier rubyid_government_bonds'>government_bonds</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_csv'>parse_csv</span><span class='lparen'>(</span><span class='id identifier rubyid_csv_file'>csv_file</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spread_to_benchmark'>spread_to_benchmark</span><span class='lparen'>(</span><span class='id identifier rubyid_corporate_bonds'>corporate_bonds</span><span class='comma'>,</span> <span class='id identifier rubyid_government_bonds'>government_bonds</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_spread_to_curve'>spread_to_curve</span><span class='lparen'>(</span><span class='id identifier rubyid_corporate_bonds'>corporate_bonds</span><span class='comma'>,</span> <span class='id identifier rubyid_government_bonds'>government_bonds</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse_csv-class_method">
  
    .<strong>parse_csv</strong>(csv_file)  &#x21d2; <tt>[Array&lt;<span class='object_link'><a href="Spread/Bond.html" title="Spread::Bond (class)">Bond</a></span>&gt;, Array&lt;<span class='object_link'><a href="Spread/Bond.html" title="Spread::Bond (class)">Bond</a></span>&gt;]</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Parses the given CSV file and splits bonds into two arrays, one for
corporate issues and one for government issues. This function will fail
with an exception if the given path does not point to a valid and properly
formatted CSV file. Input CSV file is assumed to be in the following
format:</p>

<p>bond,type,term,yield<br> C1,corporate,1.3 years,3.30%<br> G1,government,0.9
years,1.70%<br> G2,government,2.3 years,2.30%</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>csv_file</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Path to a properly formatted CSV file of bond information.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>[Array&lt;<span class='object_link'><a href="Spread/Bond.html" title="Spread::Bond (class)">Bond</a></span>&gt;, Array&lt;<span class='object_link'><a href="Spread/Bond.html" title="Spread::Bond (class)">Bond</a></span>&gt;]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A tuple of parsed Bond arrays separated by issue type in the format
[corporate_bonds, government_bonds].</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/spread.rb', line 36</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_parse_csv'>parse_csv</span><span class='lparen'>(</span><span class='id identifier rubyid_csv_file'>csv_file</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_corporate_bonds'>corporate_bonds</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_government_bonds'>government_bonds</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='comment'># This will raise a (currently un-rescued) exception if csv_file does not
</span>  <span class='comment'># point to a valid CSV file.
</span>  <span class='id identifier rubyid_input'>input</span> <span class='op'>=</span> <span class='const'>CSV</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_csv_file'>csv_file</span><span class='rparen'>)</span>

  <span class='comment'># We shift the iterator one place to skip over the header row in the CSV
</span>  <span class='comment'># file. This could be changed to check if the header is as expected, but
</span>  <span class='comment'># because I&#39;m already assuming valid input and failing outright otherwise I
</span>  <span class='comment'># didn&#39;t bother.
</span>  <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span>

  <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
    <span class='id identifier rubyid_bond'>bond</span> <span class='op'>=</span> <span class='const'>Bond</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_bond'>bond</span><span class='period'>.</span><span class='id identifier rubyid_issue'>issue</span>
    <span class='kw'>when</span> <span class='const'>CORPORATE</span>
      <span class='id identifier rubyid_corporate_bonds'>corporate_bonds</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_bond'>bond</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'>GOVERNMENT</span>
      <span class='id identifier rubyid_government_bonds'>government_bonds</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_bond'>bond</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># This sorting is important because the spread_to_curve function assumes
</span>  <span class='comment'># that these arrays are ordered by term, with shorter terms at the beginning
</span>  <span class='comment'># and longer terms at the end.
</span>  <span class='id identifier rubyid_corporate_bonds'>corporate_bonds</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_government_bonds'>government_bonds</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span> <span class='rbrace'>}</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_corporate_bonds'>corporate_bonds</span><span class='comma'>,</span> <span class='id identifier rubyid_government_bonds'>government_bonds</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="spread_to_benchmark-class_method">
  
    .<strong>spread_to_benchmark</strong>(corporate_bonds, government_bonds)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Takes an array of corporate and an array of government bonds, finds the
appropriate government benchmark bond for each corporate bond, and then
calculates the yield spreads from the corporate bonds to their
corresponding benchmark government bonds. This function writes comma-
separated values to stdout, with a newline at the end, in the following
format:</p>

<p>bond,benchmark,spread_to_yield<br> C1,G1,1.60%</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>corporate_bonds</span>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="Spread/Bond.html" title="Spread::Bond (class)">Bond</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an array of Bond objects with “corporate” issue types.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>government_bonds</span>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="Spread/Bond.html" title="Spread::Bond (class)">Bond</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an array of Bond objects with “government” issue types.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/spread.rb', line 82</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_spread_to_benchmark'>spread_to_benchmark</span><span class='lparen'>(</span><span class='id identifier rubyid_corporate_bonds'>corporate_bonds</span><span class='comma'>,</span> <span class='id identifier rubyid_government_bonds'>government_bonds</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bond,benchmark,spread_to_benchmark</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_corporate_bonds'>corporate_bonds</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_corp_bond'>corp_bond</span><span class='op'>|</span>
    <span class='id identifier rubyid_bench_spread'>bench_spread</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_benchmark'>benchmark</span> <span class='op'>=</span> <span class='kw'>nil</span>

    <span class='comment'># This block iterates through each of the government bonds and finds the
</span>    <span class='comment'># bond with the smallest term spread to use as the benchmark. Because the
</span>    <span class='comment'># government_bonds array was sorted when loaded from CSV, this loop could
</span>    <span class='comment'># be short-circuited for increased performance. However, I couldn&#39;t find a
</span>    <span class='comment'># clean way to do it, and decided that readability was more important than
</span>    <span class='comment'># a negligible performance improvement in this situation.
</span>    <span class='id identifier rubyid_government_bonds'>government_bonds</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_gov_bond'>gov_bond</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_bench_spread'>bench_spread</span> <span class='op'>==</span> <span class='kw'>nil</span>
        <span class='id identifier rubyid_bench_spread'>bench_spread</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_corp_bond'>corp_bond</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span> <span class='op'>-</span> <span class='id identifier rubyid_gov_bond'>gov_bond</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span>
        <span class='id identifier rubyid_benchmark'>benchmark</span> <span class='op'>=</span> <span class='id identifier rubyid_gov_bond'>gov_bond</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_term_spread'>term_spread</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_corp_bond'>corp_bond</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span> <span class='op'>-</span> <span class='id identifier rubyid_gov_bond'>gov_bond</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_term_spread'>term_spread</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_bench_spread'>bench_spread</span>
          <span class='id identifier rubyid_bench_spread'>bench_spread</span> <span class='op'>=</span> <span class='id identifier rubyid_term_spread'>term_spread</span>
          <span class='id identifier rubyid_benchmark'>benchmark</span> <span class='op'>=</span> <span class='id identifier rubyid_gov_bond'>gov_bond</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_spread_to_benchmark'>spread_to_benchmark</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_corp_bond'>corp_bond</span><span class='period'>.</span><span class='id identifier rubyid_yield_percent'>yield_percent</span> <span class='op'>-</span> <span class='id identifier rubyid_benchmark'>benchmark</span><span class='period'>.</span><span class='id identifier rubyid_yield_percent'>yield_percent</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_corp_bond'>corp_bond</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>,</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_benchmark'>benchmark</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>,</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_spread_to_benchmark'>spread_to_benchmark</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>%</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="spread_to_curve-class_method">
  
    .<strong>spread_to_curve</strong>(corporate_bonds, government_bonds)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Takes an array of corporate and an array of government bonds and
calculates, using linear interpolation, the spread to curve for each
corporate bond. This function writes comma-separated values to stdout, with
a newline at the end, in the following format:</p>

<p>bond,spread_to_curve<br> C1,1.22%<br> C2,2.98%</p>

<p>From <a
href="http://www.blueleafsoftware.com/Products/Dagra/LinearInterpolationExcel.php">www.blueleafsoftware.com/Products/Dagra/LinearInterpolationExcel.php</a>,
the formula for linear interpolation is as follows:</p>

<p>y = y1 + (x - x1) * ((y2 - y1) / (x2 - x1))</p>

<p>Where</p>

<p>x1 = term in years of the lower-bound benchmark government bond.<br> y1 =
yield in percentage of the lower-bound benchmark government bond.<br> x2 =
term in years of the higher-bound benchmark government bond.<br> y2 = yield
in percentage of the higher-bound benchmark government bond.<br> x = term
in years of the corporate bond whose spread-to-curve is being
calculated.<br> y = yield in percentage on the curve between benchmark
government bonds at the term of the corporate bond.</p>

<p>And the formula for spread-to-curve is as follows:</p>

<p>spread_to_curve = corporate_bond_yield - y</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>corporate_bonds</span>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="Spread/Bond.html" title="Spread::Bond (class)">Bond</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an array of Bond objects with “corporate” issue types.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>government_bonds</span>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="Spread/Bond.html" title="Spread::Bond (class)">Bond</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an array of Bond objects with “government” issue types.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/spread.rb', line 144</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_spread_to_curve'>spread_to_curve</span><span class='lparen'>(</span><span class='id identifier rubyid_corporate_bonds'>corporate_bonds</span><span class='comma'>,</span> <span class='id identifier rubyid_government_bonds'>government_bonds</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bond,spread_to_curve</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_corporate_bonds'>corporate_bonds</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_corp_bond'>corp_bond</span><span class='op'>|</span>
    <span class='id identifier rubyid_upper_bench'>upper_bench</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_lower_bench'>lower_bench</span> <span class='op'>=</span> <span class='kw'>nil</span>

    <span class='comment'># This block assumes that for every corporate bond in the given input,
</span>    <span class='comment'># there exists a government bond with a term less than or equal to the
</span>    <span class='comment'># corporate bond&#39;s term. It also assumes that there exists a government
</span>    <span class='comment'># bond with a term greater than the corporate bond&#39;s term. I added edge
</span>    <span class='comment'># case handling for a government bond with the same term as the corporate
</span>    <span class='comment'># bond, but I haven&#39;t used Ruby enough to know how it handles float
</span>    <span class='comment'># comparison, and because it wasn&#39;t part of the requirements I didn&#39;t
</span>    <span class='comment'># investigate further.
</span>    <span class='comment'>#
</span>    <span class='comment'># Note that this block assumes the government_bonds array is sorted by
</span>    <span class='comment'># ascending terms. This allows me to assume that lower_bench will always
</span>    <span class='comment'># be populated before upper_bench, which means I can short-circuit the
</span>    <span class='comment'># loop once I find my upper_bench bond.
</span>    <span class='id identifier rubyid_government_bonds'>government_bonds</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_gov_bond'>gov_bond</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_corp_bond'>corp_bond</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span> <span class='op'>==</span> <span class='id identifier rubyid_gov_bond'>gov_bond</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span>
        <span class='id identifier rubyid_lower_bench'>lower_bench</span> <span class='op'>=</span> <span class='id identifier rubyid_gov_bond'>gov_bond</span>
        <span class='kw'>break</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_gov_bond'>gov_bond</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_corp_bond'>corp_bond</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span>
        <span class='id identifier rubyid_lower_bench'>lower_bench</span> <span class='op'>=</span> <span class='id identifier rubyid_gov_bond'>gov_bond</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_upper_bench'>upper_bench</span> <span class='op'>=</span> <span class='id identifier rubyid_gov_bond'>gov_bond</span>
        <span class='kw'>break</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_lower_bench'>lower_bench</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span> <span class='op'>==</span> <span class='id identifier rubyid_corp_bond'>corp_bond</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span>
      <span class='id identifier rubyid_spread_to_curve'>spread_to_curve</span> <span class='op'>=</span> <span class='id identifier rubyid_corp_bond'>corp_bond</span><span class='period'>.</span><span class='id identifier rubyid_yield_percent'>yield_percent</span> <span class='op'>-</span> <span class='id identifier rubyid_lower_bench'>lower_bench</span><span class='period'>.</span><span class='id identifier rubyid_yield_percent'>yield_percent</span>
    <span class='kw'>else</span>
      <span class='comment'># This is the equation for linear interpolation as described above.
</span>      <span class='id identifier rubyid_yield_on_curve'>yield_on_curve</span> <span class='op'>=</span> <span class='id identifier rubyid_lower_bench'>lower_bench</span><span class='period'>.</span><span class='id identifier rubyid_yield_percent'>yield_percent</span> <span class='op'>+</span> 
                       <span class='lparen'>(</span><span class='id identifier rubyid_corp_bond'>corp_bond</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span> <span class='op'>-</span> <span class='id identifier rubyid_lower_bench'>lower_bench</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span><span class='rparen'>)</span> <span class='op'>*</span>
                       <span class='lparen'>(</span><span class='lparen'>(</span><span class='id identifier rubyid_upper_bench'>upper_bench</span><span class='period'>.</span><span class='id identifier rubyid_yield_percent'>yield_percent</span> <span class='op'>-</span> <span class='id identifier rubyid_lower_bench'>lower_bench</span><span class='period'>.</span><span class='id identifier rubyid_yield_percent'>yield_percent</span><span class='rparen'>)</span> <span class='op'>/</span>
                        <span class='lparen'>(</span><span class='id identifier rubyid_upper_bench'>upper_bench</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span> <span class='op'>-</span> <span class='id identifier rubyid_lower_bench'>lower_bench</span><span class='period'>.</span><span class='id identifier rubyid_term_years'>term_years</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='comment'># This is the equation for spread-to-curve as described above.
</span>      <span class='id identifier rubyid_spread_to_curve'>spread_to_curve</span> <span class='op'>=</span> <span class='id identifier rubyid_corp_bond'>corp_bond</span><span class='period'>.</span><span class='id identifier rubyid_yield_percent'>yield_percent</span> <span class='op'>-</span> <span class='id identifier rubyid_yield_on_curve'>yield_on_curve</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_corp_bond'>corp_bond</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>,</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_spread_to_curve'>spread_to_curve</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>%</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Oct 11 22:57:06 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.5 (ruby-2.3.1).
</div>

    </div>
  </body>
</html>